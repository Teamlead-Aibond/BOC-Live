<!-- 
    /* ===================================================
* @copyright Copyright Â 2020 - 2023 Aibond Corp.
*
* All Rights Reserved.
*
* ========================================================== */
 -->
<div class="container-fluid">
    <app-page-title title="Edit Sales Order"></app-page-title>
    <form name="form" #f="ngForm" (ngSubmit)="onSubmit(f)" novalidate>

        <div class="row">
            <div class="col-12">
                <div class="sticky-container">
                    <div id="so-groups" class="right so-groups-sticky hidden-xs" style="top:198px">


                        <button *ngIf="SalesOrderInfo.Status!=2 && IsApproveEnabled" (click)="onApprovedSO()"
                            type="button"><span>Approve SO</span>
                            <i class="fas fa-check-circle"></i></button>
                        <button *ngIf="SalesOrderInfo.Status!=3 && IsCancelSOEnabled" (click)="onCancelSO()"
                            type="button"><span>Cancel SO</span>
                            <i class="far fa-window-close"></i></button>
                        <button [disabled]="btnDisabled"
                            [ngClass]="{'class': (btnDisabled)? 'gray': 'btn-group btn-group-sm float-right'}"><span>Save</span>
                            <i class="mdi mdi-content-save "></i></button>

                        <button *ngIf="SalesOrderInfo.Status!=5" type="button" (click)="SOEmail()"><span>Email</span>
                            <i class="mdi mdi-email-outline"></i></button>

                        <!-- <button type="button" (click)="CreateCustomerInvoice()"><span>Create Customer Invoice</span>
                            <i class="fas fa-file-invoice-dollar"></i> </button> -->
                        <button
                            *ngIf="IsConvertSOToInvoiceEnabled&&SalesOrderInfo.RRId==0&&SalesOrderInfo.InvoiceId==null && SalesOrderInfo.Status==2"
                            type="button" (click)="CreateCustomerInvoice()">
                            <span>Create Customer Invoice</span><i class="fas fa-file-invoice-dollar"></i></button>
                        <button
                            *ngIf="(SalesOrderInfo.RRId==0 && SalesOrderInfo.InvoiceId!=null) && IsRevertInvoiceEnabled"
                            type="button" (click)="RevertInvoice()">
                            <span>Revert Customer Invoice</span><i class="fas fa-file-invoice-dollar"></i></button>
                        <button type="button" class="bg-danger" (click)="BackToView()"><span
                                class="bg-danger">Back</span>
                            <i class="fas fa-arrow-left"></i></button>
                    </div>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-12">
                <div class="card-box">
                    <!-- Logo & title -->
                    <div class="clearfix">
                        <div class="row">
                            <div class="col-xl-6 col-md-6 float-left">
                                <img src="assets/images/ah_logo.png" alt="" height="30">
                                <h4 class="page-title bluetxt mb-18">Sales Order #{{SalesOrderInfo.SONo}}</h4>
                            </div>

                            <div class="col-xl-6 col-md-6 sales-right">
                                <!-- <div class="btn-group btn-group-sm float-right" role="group">

                                    <button  *ngIf="SalesOrderInfo.Status!=2 && IsApproveEnabled"
                                        placement="top" class="btn btn-icon waves-effect" title="Approve SO"
                                        (click)="onApprovedSO()" type="button">
                                        <i class="fas fa-check-circle"></i></button>
                                    <button ngbTooltip="Save SO" placement="top" class="btn btn-icon waves-effect"
                                        title="Save">
                                        <i class="mdi mdi-content-save "></i></button>
                                 
                                    <button *ngIf="SalesOrderInfo.Status!=5" ngbTooltip="Email" placement="top"
                                        class="btn btn-icon waves-effect" title="Email" type="button">
                                        <i class="mdi mdi-email-outline"></i></button>

                                    <button ngbTooltip="Create Customer Invoice" placement="top" type="button"
                                        class="btn btn-icon waves-effect" title="Create Customer Invoice"
                                        (click)="CreateCustomerInvoice()">
                                        Create Invoice</button>

                                  
                                    <button ngbTooltip="Back" placement="top"
                                        class="btn btn-icon bg-danger waves-effect" title="Back"
                                        routerLink="/admin/orders/sales-list" type="button">
                                        <i class="fas fa-arrow-left"></i></button>
                                </div> -->
                            </div>
                        </div>
                    </div>
                    <div class="clear">&nbsp;</div>
                    <div class="row">
                        <div class="col-md-3">
                            <div class="mt-3 customer-detail sales-table">
                                <h4 class="page-title bluetxt mb-18">Sales Order Details</h4>
                                <div class="table-responsive">
                                    <table class="table table-borderless bill mb-0">
                                        <tbody>


                                            <tr *ngIf="RRId !=0 ">
                                                <th scope="row">
                                                    <p><strong>Repair Request # : </strong></p>
                                                </th>
                                                <td>
                                                    <p> <span><a [routerLink]="['/admin/repair-request/edit']"
                                                                [queryParams]="{RRId: this.SalesOrderInfo.RRId}"
                                                                target="_blank">{{SalesOrderInfo.RRNo}}</a></span>
                                                    </p>
                                                </td>
                                            </tr>

                                            <tr *ngIf="SalesOrderInfo.QuoteNo!='' && SalesOrderInfo.QuoteNo!=null">
                                                <th scope="row">
                                                    <p><strong>Quote # : </strong></p>
                                                </th>
                                                <td>
                                                    <p> <span><a [routerLink]="['/admin/sales-quote/list']"
                                                                [queryParams]="{QuoteId: this.SalesOrderInfo.QuoteId}"
                                                                target="_blank"
                                                                routerLink="#">{{SalesOrderInfo.QuoteNo}}</a></span>
                                                    </p>
                                                </td>
                                            </tr>
                                            <tr *ngIf="SalesOrderInfo.POId!=null">
                                                <th scope="row">
                                                    <p><strong>Purchase Order # : </strong></p>
                                                </th>
                                                <td>
                                                    <p> <span class="row"
                                                            *ngFor="let poitem of POListArray;let i = index">
                                                            <a [routerLink]="['/admin/orders/purchase-list']"
                                                                [queryParams]="{POId: poitem.POId}" target="_blank">
                                                                <p
                                                                    style="color: #09518e;text-decoration: none;background-color: transparent;">
                                                                    {{poitem.PONo}}<i *ngIf="POListArray.length>1">,</i>
                                                                </p>
                                                            </a>
                                                        </span>
                                                    </p>
                                                </td>
                                            </tr>

                                            <tr *ngIf="SalesOrderInfo.InvoiceNo!='' && SalesOrderInfo.InvoiceNo!=null">
                                                <th scope="row">
                                                    <p><strong>Invoice # : </strong></p>
                                                </th>
                                                <td>
                                                    <p> <span class="row"
                                                            *ngFor="let invoice of InvoiceListArray;let i = index"><a
                                                                [routerLink]="['/admin/invoice/list']"
                                                                [queryParams]="{InvoiceId: invoice.InvoiceId}"
                                                                target="_blank"
                                                                routerLink="#">{{invoice.InvoiceNo}}</a><i
                                                                *ngIf="InvoiceListArray.length>1">,</i></span>
                                                    </p>
                                                </td>
                                            </tr>
                                            <tr>
                                                <th>
                                                    <p><strong>Total Cost : </strong></p>
                                                </th>
                                                <td>
                                                    <p> <span>{{SalesOrderInfo.CurrencySymbol}}
                                                            {{SalesOrderInfo.GrandTotal}}</span></p>
                                                </td>
                                            </tr>

                                            <tr>
                                                <th>
                                                    <p><strong>Converted To PO : </strong></p>
                                                </th>
                                                <td>
                                                    <p> <span>{{IsConvertedToPO}}</span></p>
                                                </td>
                                            </tr>

                                            <tr>
                                                <th>
                                                    <p><strong>Customer PO # : </strong></p>
                                                </th>
                                                <td>

                                                    <p class="row">
                                                        <span style="color: #333;padding:0;"
                                                            *ngIf="SalesOrderInfo.CustomerBlanketPOId==0">{{SalesOrderInfo.CustomerPONo
                                                            || "-"}}
                                                        </span>
                                                        <a *ngIf="SalesOrderInfo.CustomerBlanketPOId!=0"
                                                            [routerLink]="['/admin/Blanket-PO-History']"
                                                            [queryParams]="{CustomerBlanketPOId: this.SalesOrderInfo.CustomerBlanketPOId}"
                                                            target="_blank" ngbTooltip="Blanket PO" placement="top">
                                                            <i style="float:left;margin-top: 2px!important;"
                                                                class="remixicon-wallet-3-fill mr-1 blanketpo-icon"></i>{{SalesOrderInfo.CustomerPONo
                                                            || "-"}}</a>
                                                        <i style="margin-top:3px !important;margin-left: 5px;float:left;cursor: pointer;"
                                                            class="remixicon-pencil-line mr-1"
                                                            ngbTooltip="Edit Customer PO" placement="top"
                                                            (click)="onUpdateCustomerPONo()"></i>
                                                    </p>

                                                </td>
                                            </tr>

                                            <!-- <tr>
                                                <th>
                                                    <p><strong>Shipping Status : </strong></p>
                                                </th>
                                                <td>
                                                    <p> <span>{{SalesOrderInfo.ShippingStatus}}</span></p>
                                                </td>
                                            </tr> -->

                                        </tbody>
                                    </table>

                                </div>


                            </div>
                        </div>
                        <div class="col-md-4">
                            <h4 style="margin-bottom: 20px;" class="page-title bluetxt">Address Details</h4>
                            <div class="row">
                                <div class="col-xl-12">
                                    <div class="form-group">
                                        <address>
                                            {{ContactAddress.StreetAddress}} {{ContactAddress.SuiteOrApt}}<br>
                                            {{ContactAddress.City}}<br>
                                            {{ContactAddress.StateName}}, {{ContactAddress.CountryName}}<br>
                                            {{ContactAddress.Zip}}
                                            <span><br><i class="mdi mdi-phone mr-1" ngbTooltip="Secondary"
                                                    *ngIf="PhoneContactAddress!= ''"></i>
                                                {{ContactAddress.PhoneNoPrimary}}</span>
                                            <span><br><i class="mdi mdi-fax mr-1" *ngIf="faxCustomerAddress!=null"></i>
                                                {{ContactAddress.Fax}}</span><br>

                                        </address>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-xl-6">
                                    <div class="form-group">
                                        <label>Bill Address:<span class="red">*</span></label>
                                        <ng-select [items]="BillAddress" [ngModelOptions]="{standalone: true}"
                                            (change)="BillingAddressChange(model.bi_BillCodeId)"
                                            [(ngModel)]="model.bi_BillCodeId" placeholder="Select" bindLabel="title"
                                            bindValue="AddressId" #bi_BillCodeId="ngModel" name="AddressId"
                                            [ngClass]="{ 'is-invalid': f.submitted && bi_BillCodeId.invalid }" required>
                                        </ng-select>
                                        <div *ngIf="f.submitted &&bi_BillCodeId.invalid" class="invalid-feedback">
                                            <div *ngIf="bi_BillCodeId.errors.required">Bill Address is required</div>
                                        </div>
                                    </div>

                                </div>

                                <div class="col-xl-6">
                                    <div class="form-group">
                                        <label>Ship Address:<span class="red">*</span><i
                                                *ngIf="SalesOrderInfo.CustomerShipIdLocked > 0" class="fa fa-lock"
                                                aria-hidden="true"></i></label>
                                        <ng-select [items]="ShipAddress" name="AddressId"
                                            [ngModelOptions]="{standalone: true}" #sh_ShipCodeId="ngModel"
                                            [ngClass]="{ 'is-invalid': f.submitted && sh_ShipCodeId.invalid }" required
                                            (change)="ShippingAddressChange(model.sh_ShipCodeId)"
                                            [(ngModel)]="model.sh_ShipCodeId" placeholder="Select" bindLabel="title"
                                            bindValue="AddressId"
                                            [disabled]="SalesOrderInfo.CustomerShipIdLocked > 0 ? true : false">
                                        </ng-select>

                                        <div *ngIf="f.submitted &&sh_ShipCodeId.invalid" class="invalid-feedback">
                                            <div *ngIf="sh_ShipCodeId.errors.required">Ship Address is required</div>
                                        </div>
                                    </div>



                                </div>
                            </div>
                            <div class="row">
                                <div class="col-xl-6">
                                    <div class="form-group">
                                        <address>
                                            {{bi_street_address}}, {{bi_SuiteOrApt}}<br>
                                            {{bi_city}}<br>
                                            {{bi_StateName}}, {{bi_CountryName}}<br>
                                            {{bi_zip}}
                                        </address>
                                    </div>

                                </div>
                                <div class="col-xl-6">
                                    <div class="form-group">
                                        <address>
                                            {{sh_street_address}}, {{sh_SuiteOrApt}}<br>
                                            {{sh_city}}<br>
                                            {{sh_StateName}}, {{sh_CountryName}}<br>
                                            {{sh_zip}}
                                        </address>


                                    </div>

                                </div>
                            </div>

                        </div>


                        <div class="col-md-5">
                            <div style="margin:15px 0 0 25px;" class="float-right">
                                <div class="row">
                                    <div class="col-xl-6">
                                        <div class="form-group" *ngIf="SalesOrderInfo.Status!=2">
                                            <label>Status:<span class="red">*</span></label>
                                            <select class="custom-select" [(ngModel)]="model.Status" #Status="ngModel"
                                                [ngClass]="{ 'is-invalid': f.submitted && Status.invalid }" required
                                                name="Status">
                                                <option value="undefined" disabled>Select</option>
                                                <option *ngFor="let SO_status of SalesOrderStatus_edit"
                                                    value="{{SO_status.Saleorder_StateId}}">
                                                    {{SO_status.Saleorder_StateName}}</option>

                                            </select>
                                            <div *ngIf="f.submitted &&Status.invalid" class="invalid-feedback">
                                                <div *ngIf="Status.errors.required">Status is required</div>
                                            </div>
                                        </div>
                                        <div class="form-group" *ngIf="SalesOrderInfo.Status==2">
                                            <label>Status:</label> {{SalesOrderInfo.StatusName}}
                                        </div>
                                    </div>
                                    <div class="col-xl-6">
                                        <div class="form-group">
                                            <label>SO Type:<span class="red">*</span></label>
                                            <select class="custom-select" [(ngModel)]="model.SOType" #SOType="ngModel"
                                                name="SOType"
                                                [ngClass]="{ 'is-invalid': f.submitted && SOType.invalid }" required>
                                                <option value="undefined" disabled>Select</option>
                                                <option *ngFor="let SO_Type of SalesOrderType"
                                                    value="{{SO_Type.SalesOrder_TypeId}}">
                                                    {{SO_Type.SalesOrder_TypeName}}</option>

                                            </select>
                                            <div *ngIf="f.submitted &&SOType.invalid" class="invalid-feedback">
                                                <div *ngIf="SOType.errors.required">SO Type is required</div>
                                            </div>

                                        </div>
                                    </div>

                                </div>
                                <div class="row">
                                    <div class="col-xl-6">
                                        <div class="form-group">
                                            <label>Requested Date:<span class="red">*</span></label>
                                            <div class="input-group clockpicker">
                                                <input ngbDatepicker class="form-control"
                                                    [(ngModel)]="model.RequestedDate" autoClose="false"
                                                    placeholder="MM/DD/YYYY" #RequestedDate="ngModel"
                                                    name="RequestedDate"
                                                    [ngClass]="{ 'is-invalid': f.submitted && RequestedDate.invalid }"
                                                    required #Requested_Date="ngbDatepicker">
                                                <div class="input-group-append" (click)="Requested_Date.toggle()">
                                                    <span class="input-group-text"><i
                                                            class="mdi mdi-calendar"></i></span>
                                                </div>
                                                <div *ngIf="f.submitted &&RequestedDate.invalid"
                                                    class="invalid-feedback">
                                                    <div *ngIf="RequestedDate.errors.required">Requested Date is
                                                        required
                                                    </div>
                                                </div>
                                            </div>


                                        </div>
                                    </div>
                                    <div class="col-xl-6">
                                        <div class="form-group">
                                            <label>Due Date:<span class="red">*</span></label>

                                            <div class="input-group clockpicker">
                                                <input ngbDatepicker class="form-control" [(ngModel)]="model.DueDate"
                                                    #DueDate="ngModel" name="DueDate"
                                                    [ngClass]="{ 'is-invalid': f.submitted && DueDate.invalid }"
                                                    required autoClose="false" placeholder="MM/DD/YYYY"
                                                    #Due_Date="ngbDatepicker">
                                                <div class="input-group-append" (click)="Due_Date.toggle()">
                                                    <span class="input-group-text"><i
                                                            class="mdi mdi-calendar"></i></span>
                                                </div>
                                                <div *ngIf="f.submitted &&DueDate.invalid" class="invalid-feedback">
                                                    <div *ngIf="DueDate.errors.required">Due Date is required</div>
                                                </div>
                                            </div>

                                        </div>
                                    </div>

                                </div>
                                <div class="row">
                                    <div class="col-xl-6">
                                        <div class="form-group">
                                            <label>Warehouse:</label>

                                            <ng-select [items]="warehouseList" name="WarehouseId"
                                                [(ngModel)]="WarehouseId" placeholder="Select" bindLabel="WarehouseName"
                                                bindValue="WarehouseId">
                                            </ng-select>


                                        </div>
                                    </div>

                                    <div class="col-xl-6">
                                        <div class="form-group">
                                            <label>Shipping Method:</label>
                                            <input class="form-control" [(ngModel)]="ShippingMethod" readonly
                                                name="ShippingMethod">
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-xl-6">
                                        <div class="form-group">
                                            <label>Facility:</label>
                                            <ng-select [items]="Facility" name="FacilityId" [(ngModel)]="FacilityId"
                                                placeholder="Select" bindLabel="FacilityCode" bindValue="FacilityId">
                                            </ng-select>
                                        </div>
                                        <!-- <div class="form-group">
                                            <label>Sales Person Name:</label>

                                            <input class="form-control" readonly>


                                        </div> -->
                                    </div>
                                    <!-- <div class="col-xl-3">

                                        <div class="form-group">
                                            <label>Customer PO NO:</label>
                                            <input class="form-control" [(ngModel)]="CustomerPONo" name="CustomerPONo">
                                        </div>

                                    </div> -->

                                    <div class="col-xl-6">
                                        <div class="form-group">
                                            <label>Reference NO:</label>
                                            <input class="form-control" [(ngModel)]="ReferenceNo" name="ReferenceNo">
                                        </div>
                                    </div>
                                </div>
                                <div class="row" *ngIf="SalesOrderInfo.Status==2">
                                    <div class="col-xl-6">
                                        <div class="form-group">
                                            <label>Approved By:</label>

                                            <span class="approvebg">{{SalesOrderInfo.ApprovedByName}}</span>


                                        </div>
                                    </div>
                                    <div class="col-xl-6">

                                        <div class="form-group">
                                            <label>Approved Date:</label> {{SalesOrderInfo.ApprovedDate|dateTransform}}
                                        </div>

                                    </div>

                                </div>
                            </div>
                        </div>

                    </div>
                    <div class="clear">&nbsp;</div>

                    <div class="col-md-12">
                        <div class="row">
                            <div class="col-xl-12">
                                <div class="form-group">
                                    <h4 class="page-title bluetxt mb-20">Customer Reference Number</h4>
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="table-responsive">
                                <table class="table-bordered table nowrap">
                                    <tbody>
                                        <tr>
                                            <th>CR #</th>
                                            <th>Reference Name</th>
                                            <th>Value</th>
                                            <th>Action</th>
                                        </tr>
                                        <tr *ngFor="let item of SalesOrderCustomerRef ; let i = index;let last=last;">
                                            <td>{{i+1}}</td>
                                            <td>{{item.ReferenceLabelName}}</td>
                                            <td>{{item.ReferenceValue}}</td>
                                            <td>
                                                <a (click)="deleteReference(i)" class="fa fa-trash text-danger"
                                                    ngbTooltip="Delete" placement="top"></a>
                                            </td>
                                        </tr>
                                        <tr *ngIf="SalesOrderCustomerRef?.length == 0">
                                            <td colspan="5" class="no-data-available">No data!</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>


                        </div>
                        <div class="row mt-1 mr-1 float-right">
                            <div class="custom-control custom-switch ">
                                <button class="btn btn-pink btn-sm waves-effect raa" type="button"
                                    *ngIf="CustomerId != '' && CustomerId != null && CustomerId != 0 && SalesOrderCustomerRef.length < 6"
                                    (click)="addReferenceType()">
                                    <i class="remixicon-add-fill mrg-5"></i> Add Reference Type
                                </button>
                            </div>
                            <div class="custom-control custom-switch ">
                                <button class="btn btn-primary btn-sm waves-effect" type="button"
                                    (click)="addReference()">
                                    <i class="remixicon-add-fill mrg-5"></i> Add
                                </button>
                            </div>
                        </div>

                    </div>


                    <!-- end row -->
                    <div class="clear">&nbsp;</div>
                    <div class="row" *ngIf="showlineItem">
                        <div class="col-12 col-xl-12">
                            <h4 class="page-title bluetxt mb-20">Item Details
                                <div style="float: right;">
                                    <button (click)="CreatePO()"
                                        *ngIf="RRId==0 && SalesOrderInfo.MROId==0 && (SalesOrderInfo.POId == null) "
                                        type="button" class="btn btn-purple waves-effect">
                                        Create PO
                                    </button>
                                    &nbsp; &nbsp;
                                    <button (click)="AddItem()" type="button" class="btn btn-add waves-effect"
                                        *ngIf="SalesOrderInfo.MROId==0" style="margin-top: 2px;">
                                        <i class="remixicon-add-fill mt-3"></i> Add
                                    </button>
                                </div>
                            </h4>
                        </div>
                    </div>
                    <div class="row" *ngIf="showlineItem">
                        <div class="col-12 col-xl-12">
                            <div class="table-responsive">
                                <table class="idetail table mt-2 table-bordered mb-0">
                                    <thead class="thead-light">
                                        <tr>
                                            <!-- <th>
                                                <input type="checkbox" (change)="isAllSelected($event)"  [disabled]="Selectallenable"
                                               >
                                            </th> -->
                                            <th>Part #<span class="red">*</span></th>
                                            <th>Description</th>
                                            <th>Lead Time</th>
                                            <th>Quantity<span class="red">*</span></th>
                                            <th>Unit Price<span class="red">*</span></th>
                                            <th>{{VAT_field_Name}}</th>
                                            <th *ngIf="SalesOrderInfo.MROId != 0">{{Shipping_field_Name}}</th>
                                            <th>Price<span class="red">*</span></th>
                                            <th *ngIf="IsDisplayBaseCurrencyValue==1">Price({{BaseCurrencySymbol}})<span
                                                    class="red">*</span></th>
                                            <th>Warranty Period<span class="red">*</span></th>
                                            <th>Action</th>
                                        </tr>
                                    </thead>
                                    <tbody *ngFor="let item of PartItem;let i=index;">
                                        <tr>
                                            <!-- <td><input type="checkbox" [checked]="item.checked" [disabled]="item.POItemId != 0"
                                                (change)="CreatePOItem($event,i)"></td> -->
                                            <td style="width: 20%;" class="ng-autocomplete">

                                                <ng-autocomplete [data]="filteredData" [isLoading]="isLoading"
                                                    [searchKeyword]="keyword" (selected)='selectEvent($event,i)'
                                                    [(ngModel)]="PartItem[i].Part"
                                                    (inputChanged)='onChangeSearch($event,i)' placeholder="Enter Part #"
                                                    (inputFocused)='onFocused($event,i)' [itemTemplate]="itemTemplate"
                                                    [notFoundTemplate]="notFoundTemplate" debounceTime="1000"
                                                    #Part="ngModel" name="Part[{{i}}]"
                                                    [ngClass]="{ 'is-invalid': f.submitted && Part.invalid }" required>
                                                </ng-autocomplete>

                                                <!-- <div class="input-group" *ngIf="item.POId && RRId==0"><strong>PO #:</strong><a [routerLink]="['/admin/orders/purchase-list']" [queryParams]="{POId: item.POId}"  target="_blank"  ngbTooltip="PO View">{{item.PONo}}</a></div> -->
                                                <ng-template #itemTemplate let-item>
                                                    <a [innerHTML]="item.PartNo"></a>
                                                </ng-template>
                                                <ng-template #notFoundTemplate let-notFound>
                                                    <div [innerHTML]="notFound"></div>
                                                </ng-template>
                                                <input type="hidden" name="PartNo" [(ngModel)]="PartItem[i].PartId">

                                                <input type="hidden" name="PartNo" [(ngModel)]="PartItem[i].PartNo">
                                                <br>


                                                <div *ngIf="f.submitted &&Part.invalid" class="invalid-feedback">
                                                    <div *ngIf="Part.errors.required">Part is required</div>
                                                </div>
                                            </td>
                                            <td style="width: 15%;">
                                                <textarea class="form-control" placeholder="Description..."
                                                    name="PartDescription[{{i}}]"
                                                    [(ngModel)]="PartItem[i].PartDescription" rows="3"></textarea>



                                                <br>
                                                <!-- <div class="pon" *ngFor="let item of PartItem[i].LPPList; let i =index">
                                                    <b>LPP {{i+1}}</b>:&nbsp;$ {{item.LPP}},&nbsp;</div> -->
                                            </td>
                                            <td style="width: 12%;">
                                                <div class="input-group">
                                                    <input type="text" digitOnly class="form-control"
                                                        name="LeadTime[{{i}}]" [(ngModel)]="PartItem[i].LeadTime">
                                                    <div class="input-group-append">
                                                        <span class="input-group-text">Day(s)</span>
                                                    </div>

                                                </div>

                                            </td>
                                            <td style="width: 5%;">
                                                <input type="text" min="1" class="form-control" name="Quantity[{{i}}]"
                                                    [disabled]="SalesOrderInfo.MROId != 0" digitOnly
                                                    [(ngModel)]="PartItem[i].Quantity" #Quantity="ngModel"
                                                    [ngClass]="{ 'is-invalid': f.submitted && Quantity.invalid }"
                                                    required (keyup)="calculatePrice(i)">
                                                <div *ngIf="f.submitted &&Quantity.invalid" class="invalid-feedback">
                                                    <div *ngIf="Quantity.errors.required">Quantity is required</div>
                                                </div>
                                            </td>
                                            <td style="width: 12%;">
                                                <div class="input-group">
                                                    <div class="input-group-prepend">
                                                        <span
                                                            class="input-group-text">{{PartItem[i].ItemLocalCurrencySymbol}}</span>
                                                    </div>
                                                    <input id="Rate" type="text" name="Rate[{{i}}]"
                                                        [(ngModel)]="PartItem[i].Rate" class="form-control"
                                                        inputmode="numeric" pattern="^\d+(\.\d{1,2})?$"
                                                        placeholder="0.00" digitOnly #Rate="ngModel"
                                                        [ngClass]="{ 'is-invalid': f.submitted && Rate.invalid }"
                                                        required decimal="true" (keyup)="calculatePrice(i)" />
                                                    <div *ngIf="f.submitted &&Rate.invalid" class="invalid-feedback">
                                                        <div *ngIf="Rate.errors.required">Unit Price is required
                                                        </div>
                                                    </div>
                                                    <!-- <div class="newprice" *ngIf="PartItem[i].Rate">
                                                        <br> {{PartItem[i].NewPricePercent | number}}% of New<br> Save : $ {{PartItem[i].SaveAmount}}
                                                    </div> -->
                                                </div>

                                            </td>
                                            <td style="width: 10%;">
                                                <div class="input-group">
                                                    <div class="input-group-prepend">
                                                        <span class="input-group-text">%</span>
                                                    </div>
                                                    <input type="text" min="1" class="form-control"
                                                        [(ngModel)]="PartItem[i].ItemTaxPercent"
                                                        #ItemTaxPercent="ngModel" inputmode="numeric"
                                                        pattern="^\d+(\.\d{1,2})?$" placeholder="0.00" digitOnly
                                                        decimal="true" name="ItemTaxPercent[{{i}}]"
                                                        (keyup)="calculatePrice(i)">
                                                </div>
                                                &nbsp;
                                                <div class="input-group">
                                                    <div class="input-group-prepend">
                                                        <span
                                                            class="input-group-text">{{PartItem[i].ItemLocalCurrencySymbol}}</span>
                                                    </div>
                                                    <input type="hidden" class="form-control" readonly #Tax="ngModel"
                                                        name="Tax[{{i}}]" [(ngModel)]="PartItem[i].Tax">
                                                    <input type="text" class="form-control" readonly #TaxWithQuantity="ngModel"
                                                        name="TaxWithQuantity[{{i}}]" [(ngModel)]="PartItem[i].TaxWithQuantity">
                                                        
                                                </div>
                                            </td>
                                            <td style="width: 8%;" *ngIf="SalesOrderInfo.MROId != 0">

                                                <div class="input-group">
                                                    <div class="input-group-prepend">
                                                        <span
                                                            class="input-group-text">{{PartItem[i].ItemLocalCurrencySymbol}}</span>
                                                    </div>
                                                    <input type="text" class="form-control" (keyup)="calculatePrice(i)"
                                                        #ShippingCharge="ngModel" name="ShippingCharge[{{i}}]"
                                                        inputmode="numeric" pattern="^\d+(\.\d{1,2})?$"
                                                        placeholder="0.00" digitOnly decimal="true"
                                                        [(ngModel)]="PartItem[i].ShippingCharge">

                                                </div>
                                            </td>
                                            <td style="width: 10%;">
                                                <div class="input-group">
                                                    <div class="input-group-prepend">
                                                        <span
                                                            class="input-group-text">{{PartItem[i].ItemLocalCurrencySymbol}}</span>
                                                    </div>
                                                    <input type="text" class="form-control" name="Price[{{i}}]" readonly
                                                        #Price="ngModel"
                                                        [ngClass]="{ 'is-invalid': f.submitted && Price.invalid }"
                                                        required [(ngModel)]="PartItem[i].Price">
                                                    <div *ngIf="f.submitted &&Price.invalid" class="invalid-feedback">
                                                        <div *ngIf="Price.errors.required">Price is required</div>
                                                    </div>
                                                </div>

                                            </td>
                                            <td style="width: 10%;" *ngIf="IsDisplayBaseCurrencyValue==1">
                                                <div class="input-group">
                                                    <div class="input-group-prepend">
                                                        <span class="input-group-text">{{BaseCurrencySymbol}}</span>
                                                    </div>
                                                    <input type="text" class="form-control" readonly
                                                        #BasePrice="ngModel" name="BasePrice[{{i}}]"
                                                        [ngClass]="{ 'is-invalid': f.submitted && BasePrice.invalid }"
                                                        required [(ngModel)]="PartItem[i].BasePrice">
                                                    <div *ngIf="f.submitted &&BasePrice.invalid"
                                                        class="invalid-feedback">
                                                        <div *ngIf="BasePrice.errors.required">
                                                            Price({{BaseCurrencySymbol}}) is required</div>
                                                    </div>
                                                </div>

                                            </td>
                                            <td style="width: 12%;">
                                                <select class="custom-select" name="WarrantyPeriod[{{i}}]"
                                                    #WarrantyPeriod="ngModel"
                                                    [ngClass]="{ 'is-invalid': f.submitted && WarrantyPeriod.invalid }"
                                                    required [(ngModel)]="PartItem[i].WarrantyPeriod">
                                                    <option value="undefined">Select</option>
                                                    <option *ngFor="let warranty of warrantyList"
                                                        value="{{warranty.WarrantyPeriodId}}">
                                                        {{warranty.WarrantyPeriodValue}}
                                                    </option>
                                                </select>
                                                <div *ngIf="f.submitted &&WarrantyPeriod.invalid"
                                                    class="invalid-feedback">
                                                    <div *ngIf="WarrantyPeriod.errors.required">Warranty Period is
                                                        required
                                                    </div>
                                                </div>
                                            </td>
                                            <!-- <td style="width: 2%;">
                                                <a (click)="removePartItem(i,item.SOItemId)" *ngIf="i != 0"
                                                    class="text-danger" style="cursor: pointer;"> <i
                                                        class="remixicon-delete-bin-line delete-btn-ico"></i></a>
                                            </td> -->
                                            <td style="width: 2%;">
                                                <a (click)="removePartItem(i,item.SOItemId)" *ngIf="i != 0"
                                                    class="text-danger" style="cursor: pointer;"> <i
                                                        class="remixicon-delete-bin-line delete-btn-ico"></i></a>
                                                &nbsp;&nbsp;
                                                <button (click)="onVoidPartItem(i,item.SOItemId)"
                                                    *ngIf="IsVoidLineItemPriceEnabled" type="button"
                                                    class="btn btn-pink waves-effect">
                                                    Void
                                                </button>

                                                <!-- &nbsp;&nbsp;
                                                        <a ngbTooltip="Move this Part to Excluded Part List" style="cursor: pointer;" *ngIf="RRId ==0" (click)="onMovetoExcludedParts(i,item.SOItemId,item)"> <i
                                                        class="remixicon-arrow-down-fill arrow-btn-ico"></i></a>  -->
                                            </td>
                                        </tr>

                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                    <div class="clear">&nbsp;</div>
                    <h4 class="page-title bluetxt mb-20"><span
                            *ngIf="showExcludedPartItem && ExcludedPartItem.length>0">Excluded Part Details</span>
                        <button (click)="AddExcludedPartItem()" type="button" class="btn btn-add waves-effect"
                            *ngIf="showlineItem && SalesOrderInfo.MROId==0">
                            <i class="remixicon-add-fill mt-3"></i> Add Excluded Part
                        </button>
                    </h4>
                    <div class="table-responsive" *ngIf="showExcludedPartItem&& ExcludedPartItem.length>0">
                        <table class="table table-bordered idt mb-0">
                            <thead class="thead-light">
                                <tr>
                                    <th>Part #<span class="red">*</span></th>
                                    <th>Description</th>
                                    <th>Lead Time</th>
                                    <th>Quantity<span class="red">*</span></th>
                                    <th>Unit Price<span class="red">*</span></th>
                                    <th>{{VAT_field_Name}}</th>
                                    <th>Price<span class="red">*</span></th>
                                    <th *ngIf="IsDisplayBaseCurrencyValue==1">Price({{BaseCurrencySymbol}})<span
                                            class="red">*</span></th>
                                    <th>Warranty Period<span class="red">*</span></th>
                                    <th>Action</th>

                                </tr>
                            </thead>
                            <tbody *ngFor="let item of ExcludedPartItem; let j = index;">
                                <tr>
                                    <td style="width: 20%;" class="ng-autocomplete">

                                        <ng-autocomplete [data]="filteredData" [isLoading]="isLoading"
                                            [searchKeyword]="keyword" (selected)='selectExcludedPartItemEvent($event,j)'
                                            [(ngModel)]="ExcludedPartItem[j].Part"
                                            (inputChanged)='onChangeSearch($event,j)' placeholder="Enter Part #"
                                            (inputFocused)='onFocused($event,j)' [itemTemplate]="itemTemplate"
                                            [notFoundTemplate]="notFoundTemplate" debounceTime="1000" #Part="ngModel"
                                            name="ExcludedPartItem[{{j}}].Part"
                                            [ngClass]="{ 'is-invalid': f.submitted && Part.invalid }" required>
                                        </ng-autocomplete>

                                        <ng-template #itemTemplate let-item>
                                            <a [innerHTML]="item.PartNo"></a>
                                        </ng-template>

                                        <ng-template #notFoundTemplate let-notFound>
                                            <div [innerHTML]="notFound"></div>
                                        </ng-template>
                                        <input type="hidden" name="ExcludedPartItem[{{j}}].PartNo"
                                            [(ngModel)]="ExcludedPartItem[j].PartId">

                                        <input type="hidden" name="ExcludedPartItem[{{j}}].PartNo"
                                            [(ngModel)]="ExcludedPartItem[j].PartNo">
                                        <br>


                                        <div *ngIf="f.submitted &&Part.invalid" class="invalid-feedback">
                                            <div *ngIf="Part.errors.required">Part is required</div>
                                        </div>
                                    </td>
                                    <td style="width: 15%;">
                                        <textarea class="form-control" placeholder="Description..."
                                            name="ExcludedPartItem[{{j}}].PartDescription"
                                            [(ngModel)]="ExcludedPartItem[j].PartDescription" rows="3"></textarea>

                                    </td>
                                    <td style="width: 12%;">
                                        <div class="input-group">
                                            <input type="text" digitOnly class="form-control"
                                                name="ExcludedPartItem[{{j}}].LeadTime" #LeadTime="ngModel"
                                                [(ngModel)]="ExcludedPartItem[j].LeadTime">
                                            <div class="input-group-append">
                                                <span class="input-group-text">Day(s)</span>
                                            </div>
                                            <!-- [ngClass]="{ 'is-invalid': f.submitted && LeadTime.invalid }"
                                                required -->
                                            <!-- <div *ngIf="f.submitted &&LeadTime.invalid"
                                                class="invalid-feedback">
                                                <div *ngIf="LeadTime.errors.required">Lead Time is required
                                                </div>
                                            </div> -->
                                        </div>

                                    </td>
                                    <td style="width: 5%;">
                                        <input type="text" min="1" class="form-control"
                                            name="ExcludedPartItem[{{j}}].Quantity"
                                            [(ngModel)]="ExcludedPartItem[j].Quantity" #Quantity="ngModel"
                                            [ngClass]="{ 'is-invalid': f.submitted && Quantity.invalid }" required
                                            digitOnly (keyup)="ExcludedPartcalculatePrice(j)">

                                        <div *ngIf="f.submitted &&Quantity.invalid" class="invalid-feedback">
                                            <div *ngIf="Quantity.errors.required">Quantity is required</div>
                                        </div>
                                    </td>
                                    <td style="width: 12%;">
                                        <div class="input-group">
                                            <div class="input-group-prepend">
                                                <span
                                                    class="input-group-text">{{ExcludedPartItem[j].ItemLocalCurrencySymbol}}</span>
                                            </div>
                                            <input id="Rate" type="text" name="ExcludedPartItem[{{j}}].Rate"
                                                [(ngModel)]="ExcludedPartItem[j].Rate" class="form-control"
                                                inputmode="numeric" pattern="^\d+(\.\d{1,2})?$" placeholder="0.00"
                                                digitOnly #Rate="ngModel"
                                                [ngClass]="{ 'is-invalid': f.submitted && Rate.invalid }" required
                                                decimal="true" (keyup)="ExcludedPartcalculatePrice(j)" />
                                            <div *ngIf="f.submitted &&Rate.invalid" class="invalid-feedback">
                                                <div *ngIf="Rate.errors.required">Unit Price is required</div>
                                            </div>

                                        </div>

                                    </td>

                                    <td style="width: 10%;">
                                        <div class="input-group">
                                            <div class="input-group-prepend">
                                                <span class="input-group-text">%</span>
                                            </div>
                                            <input type="text" min="1" class="form-control"
                                                [(ngModel)]="ExcludedPartItem[j].ItemTaxPercent"
                                                #ItemTaxPercent="ngModel" inputmode="numeric"
                                                pattern="^\d+(\.\d{1,2})?$" placeholder="0.00" digitOnly decimal="true"
                                                name="ExcludedPartItem[{{j}}].ItemTaxPercent"
                                                (keyup)="ExcludedPartcalculatePrice(j)">
                                        </div>
                                        &nbsp;
                                        <div class="input-group">
                                            <div class="input-group-prepend">
                                                <span
                                                    class="input-group-text">{{ExcludedPartItem[j].ItemLocalCurrencySymbol}}</span>
                                            </div>
                                            <input type="hidden" class="form-control" readonly #Tax="ngModel"
                                                name="ExcludedPartItem[{{j}}].Tax"
                                                [(ngModel)]="ExcludedPartItem[j].Tax">
                                            <input type="text" class="form-control" readonly #TaxWithQuantity="ngModel"
                                                name="ExcludedPartItem[{{j}}].TaxWithQuantity"
                                                [(ngModel)]="ExcludedPartItem[j].TaxWithQuantity">

                                        </div>
                                    </td>
                                    <td style="width: 10%;">
                                        <div class="input-group">
                                            <div class="input-group-prepend">
                                                <span
                                                    class="input-group-text">{{ExcludedPartItem[j].ItemLocalCurrencySymbol}}</span>
                                            </div>
                                            <input type="text" class="form-control" readonly
                                                name="ExcludedPartItem[{{j}}].Price" #Price="ngModel"
                                                [ngClass]="{ 'is-invalid': f.submitted && Price.invalid }" required
                                                [(ngModel)]="ExcludedPartItem[j].Price">
                                            <div *ngIf="f.submitted &&Price.invalid" class="invalid-feedback">
                                                <div *ngIf="Price.errors.required">Price is required</div>
                                            </div>
                                        </div>

                                    </td>
                                    <td style="width: 10%;" *ngIf="IsDisplayBaseCurrencyValue==1">
                                        <div class="input-group">
                                            <div class="input-group-prepend">
                                                <span class="input-group-text">{{BaseCurrencySymbol}}</span>
                                            </div>
                                            <input type="text" class="form-control" readonly #BasePrice="ngModel"
                                                name="ExcludedPartItem[{{j}}].BasePrice"
                                                [ngClass]="{ 'is-invalid': f.submitted && BasePrice.invalid }" required
                                                [(ngModel)]="ExcludedPartItem[j].BasePrice">
                                            <div *ngIf="f.submitted &&BasePrice.invalid" class="invalid-feedback">
                                                <div *ngIf="BasePrice.errors.required">Price({{BaseCurrencySymbol}}) is
                                                    required</div>
                                            </div>
                                        </div>

                                    </td>
                                    <td style="width: 12%;">
                                        <select class="custom-select" name="ExcludedPartItem[{{j}}].WarrantyPeriod"
                                            #WarrantyPeriod="ngModel"
                                            [ngClass]="{ 'is-invalid': f.submitted && WarrantyPeriod.invalid }" required
                                            [(ngModel)]="ExcludedPartItem[j].WarrantyPeriod">
                                            <option value="undefined">Select</option>
                                            <option *ngFor="let warranty of warrantyList"
                                                value="{{warranty.WarrantyPeriodId}}">
                                                {{warranty.WarrantyPeriodValue}}
                                            </option>
                                        </select>
                                        <div *ngIf="f.submitted &&WarrantyPeriod.invalid" class="invalid-feedback">
                                            <div *ngIf="WarrantyPeriod.errors.required">Warranty Period is
                                                required
                                            </div>
                                        </div>
                                    </td>
                                    <!-- <td style="width: 2%;">
                                        <a (click)="removeExcludedPartItem(j)" *ngIf="j != 0" class="text-danger"
                                            style="cursor: pointer;"> <i
                                                class="remixicon-delete-bin-line delete-btn-ico"></i></a>
                                    </td> -->
                                    <td style="width: 2%;">
                                        <!-- <a (click)="removeExcludedPartItem(j,item.SOItemId)" class="text-danger" *ngIf="j != 0"
                                            style="cursor: pointer;"> <i
                                                class="remixicon-delete-bin-line delete-btn-ico"></i></a> -->
                                        <a (click)="removeExcludedPartItem(j,item.SOItemId)" class="text-danger"
                                            style="cursor: pointer;"> <i
                                                class="remixicon-delete-bin-line delete-btn-ico"></i></a>
                                        &nbsp;&nbsp;
                                        <button (click)="onVoid(j,item.SOItemId)" *ngIf="IsVoidLineItemPriceEnabled"
                                            type="button" class="btn btn-pink waves-effect">
                                            Void
                                        </button>

                                        <!-- &nbsp;&nbsp;
                                                        <a ngbTooltip="Move this Part to Item Details" style="cursor: pointer;" *ngIf="RRId ==0" (click)="onMovetoParts(j,item.SOItemId,item)"> <i
                                                        class="remixicon-arrow-up-fill arrow-btn-ico"></i></a>  -->
                                    </td>
                                </tr>

                            </tbody>
                        </table>
                        <br>


                    </div>
                    <div class="clear">&nbsp;</div>
                    <div class="row" *ngIf="showlineItem">
                        <div class="col-xl-12">
                            <div class="float-right">

                                <div class="table-responsive">
                                    <table class="table table-borderless bill mb-0">
                                        <tbody>
                                            <!-- <tr>
                                                <th scope="row">
                                                    <p><b>Sub Total:</b></p>
                                                </th>
                                                <td>
                                                    $ {{SubTotal}}
                                                    <input type="hidden" class="form-control" name="SubTotal"
                                                        [(ngModel)]="SubTotal" readonly>
                                                </td>
                                            </tr>

                                            <tr>
                                                <th scope="row">
                                                    <p><b>Total Tax:</b></p>
                                                </th>
                                                <td>
                                                    <div class="row">
                                                        <div class="col-xl-6 soe">
                                                            <div class="input-group">
                                                                <div class="input-group-prepend">
                                                                    <span class="input-group-text">$</span>
                                                                </div>
                                                                <input type="text" inputmode="numeric"
                                                                    pattern="^\d+(\.\d{1,2})?$" placeholder="0.00"
                                                                    digitOnly decimal="true" class="form-control"
                                                                    name="TotalTax" readonly [(ngModel)]="TotalTax" >
                                                            </div>
                                                        </div>
                                                        <div class="col-xl-6 soe">
                                                            <div class="input-group">
                                                                <div class="input-group-prepend">
                                                                    <span class="input-group-text">%</span>
                                                                </div>
                                                                <input type="text" inputmode="numeric"
                                                                    pattern="^\d+(\.\d{1,2})?$" placeholder="0.00"
                                                                    digitOnly decimal="true" class="form-control"
                                                                    (keyup)="calculateTax()" name="TaxPercent"
                                                                    [(ngModel)]="TaxPercent" readonly>
                                                            </div>
                                                        </div>
                                                    </div>

                                                </td>
                                            </tr>

                                            <tr>
                                                <th scope="row">
                                                    <p><b>Discount :</b></p>
                                                </th>
                                                <td>
                                                    <div class="input-group">
                                                        <div class="input-group-prepend">
                                                            <span class="input-group-text">$</span>
                                                        </div>
                                                        <input type="text" digitOnly class="form-control"
                                                            name="Discount" (keyup)="calculateTotal()"
                                                            [(ngModel)]="Discount" readonly>
                                                    </div>
                                                </td>
                                            </tr>

                                            <tr>
                                                <th scope="row">
                                                    <p><b>Shipping :</b></p>
                                                </th>
                                                <td>
                                                    <div class="input-group">
                                                        <div class="input-group-prepend">
                                                            <span class="input-group-text">$</span>
                                                        </div>
                                                        <input type="text" digitOnly class="form-control"
                                                            name="Shipping" (keyup)="calculateTotal()"
                                                            [(ngModel)]="Shipping" readonly>
                                                    </div>
                                                </td>
                                            </tr>


                                            <tr>
                                                <th scope="row">
                                                    <p><b>AH Processing Fee :</b></p>
                                                </th>
                                                <td>
                                                    <div class="input-group">
                                                        <div class="input-group-prepend">
                                                            <span class="input-group-text">$</span>
                                                        </div>
                                                        <input type="text" digitOnly class="form-control" name="AHFees"
                                                            (keyup)="calculateTotal()" [(ngModel)]="AHFees" readonly>
                                                    </div>
                                                </td>
                                            </tr> -->
                                            <tr *ngIf='BlanketPOExcludeAmount > 0'>
                                                <th scope="row">
                                                    <p><b>Blanket PO Exclude Amount :</b></p>
                                                </th>
                                                <td>
                                                    <p>{{Symbol}} {{BlanketPOExcludeAmount}}</p>
                                                </td>
                                            </tr>


                                            <tr *ngIf='BlanketPOExcludeAmount > 0'>
                                                <th scope="row">
                                                    <p><b>Blanket PO Chargeable Amount :</b></p>
                                                </th>
                                                <td>
                                                    <p>{{Symbol}} {{BlanketPONetAmount}} </p>
                                                </td>
                                            </tr>

                                            <tr>
                                                <th scope="row">
                                                    <p><b>Grand Total :</b></p>
                                                </th>
                                                <td>
                                                    <p>{{Symbol}} {{GrandTotal}} </p>
                                                    <input type="hidden" class="form-control" name="GrandTotal"
                                                        [(ngModel)]="GrandTotal">
                                                </td>
                                            </tr>
                                            <tr *ngIf="IsDisplayBaseCurrencyValue==1">
                                                <th scope="row">
                                                    <p><b>Grand Total ({{BaseCurrencySymbol}}) :</b></p>
                                                </th>
                                                <td>
                                                    <p>{{BaseCurrencySymbol}} {{GrandTotalUSD}} </p>

                                                </td>
                                            </tr>

                                        </tbody>
                                    </table>
                                </div>











                            </div>
                            <div class="clearfix"></div>
                        </div>
                        <!-- end col -->
                    </div>
                    <div class="clear">&nbsp;</div>
                    <h4 class="page-title bluetxt mb-10">Notes
                        <button (click)="addNotes()" type="button" class="btn btn-add waves-effect">
                            <i class="remixicon-add-fill mt-3"></i> Add
                        </button>
                    </h4>
                    <div class="table-responsive mt-15">
                        <table class="table table-bordered table-striped mb-0">
                            <thead class="thead-light">
                                <tr>
                                    <th>Notes</th>
                                    <th>Action</th>
                                </tr>
                            </thead>
                            <tbody *ngFor="let note of SONotes;let i=index">
                                <tr>
                                    <td class="linebreak">{{note.Notes}}</td>
                                    <td>
                                        <a (click)="editNotes(note,i)" class="fa fa-edit" ngbTooltip="Edit"
                                            placement="top"></a>&nbsp;
                                        <a (click)="deleteNotes(note.NotesId,i)" class="fa fa-trash text-danger"
                                            ngbTooltip="Delete" placement="top"></a>
                                    </td>
                                </tr>
                            </tbody>
                            <tbody *ngIf="SONotes?.length == 0">
                                <tr>
                                    <td colspan="5" class="no-data-available">No data!</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>


                    <div class="clear">&nbsp;</div>


                    <h4 class="page-title bluetxt mb-10">Attachments <button type="button" (click)="addAttachment()"
                            class="btn btn-add waves-effect"><i class="remixicon-add-fill mt-3"></i>
                            Add</button></h4>
                    <div class="table-responsive mt-15">
                        <table class="table table-bordered table-striped mb-0">
                            <thead class="thead-light">
                                <tr>
                                    <th>Type</th>
                                    <th class="linebreak">Description</th>
                                    <th>Attachment</th>
                                    <th>Action</th>
                                </tr>
                            </thead>
                            <tbody *ngFor="let attachment of AttachmentList;let i=index">
                                <tr>
                                    <td>{{attachment.AttachmentTypeName}}</td>
                                    <td>{{attachment.AttachmentDesc}}</td>
                                    <td><a href="{{attachment.Attachment}}"
                                            target="_blank">{{attachment.AttachmentOriginalFile}}</a></td>
                                    <td>
                                        <a (click)="editAttachment(attachment,i)" class="fa fa-edit" ngbTooltip="Edit"
                                            placement="top"></a>&nbsp;
                                        <a (click)="deleteAttachment(attachment.AttachmentId,i)"
                                            class="fa fa-trash text-danger" ngbTooltip="Delete" placement="top"></a>
                                    </td>
                                </tr>
                            </tbody>
                            <tbody *ngIf="AttachmentList?.length == 0">
                                <tr>
                                    <td colspan="5" class="no-data-available">No data!</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                </div>
                <!-- end card-box -->
            </div>
            <!-- end col -->
        </div>
    </form>
</div>