<div class="row" *ngIf="workchainAlert == '0' && workchainCount > 0">
    <div class="col-12">
        <div class="alert alert-custom alert-danger alert-dismissible" *ngIf="isClosed"
            style="font-size: 1.1rem;  text-align: center;  font-weight: bold;" role="alert">
            Alert! You have {{workchainCount}} task pending in your Workchain.
            <button type="button" class="close" (click)="closeWorkchainAlert()" data-dismiss="alert" aria-label="Close">
                <span aria-hidden="true">&times;</span>
            </button>
        </div>
    </div>
</div>
<div class="navbar-custom">
    <div class="container-fluid">
        <ul class="list-unstyled topnav-menu float-right mb-0">

            <li class="dropdown notification-list">
                <a class="navbar-toggle nav-link" [ngClass]="{'open': openMobileMenu}"
                    (click)="toggleMobileMenu($event)">
                    <div class="lines">
                        <span></span>
                        <span></span>
                        <span></span>
                    </div>
                </a>
            </li>

            <li class="d-none d-sm-block">
                <form class="app-search">
                    <div class="app-search-box topright-wrap">
                        <div class="input-group col-xl-12 nopad">
                            <ng-select [items]="globalSearch$ | async" [typeahead]="globalSearchInput$"
                                [loading]="loadingGlobalSearch" [multiple]="false" [closeOnSelect]="false"
                                [searchable]="true" [virtualScroll]="true" (click)="onEnter($event)"
                                placeholder="Search..." bindLabel="IdentityNo" [(ngModel)]="searchQuery"
                                [ngModelOptions]="{standalone: true}">
                                <ng-template ng-multi-label-tmp let-items="items" let-clear="clear">
                                    <div class="ng-value" *ngFor="let item of items | slice:0:1">
                                        <span class="ng-value-label">{{item.IdentityNo}}</span>
                                        <span class="ng-value-icon right" (click)="clear(item)"
                                            aria-hidden="true">Ã—</span>
                                    </div>
                                    <div class="ng-value" *ngIf="items.length > 1">
                                        <span class="ng-value-label">+ {{items.length - 1}} more...</span>
                                    </div>
                                </ng-template>
                                <ng-template ng-option-tmp let-item="item" let-item$="item$" let-index="index">
                                    <ng-container *ngIf="identityType != '1' && identityType != '2'">

                                        <a *ngIf="item.IdentityType==3" [routerLink]="['/admin/repair-request/edit']"
                                            [queryParams]="{RRId: item.IdentityId}" target="_blank" routerLink="#">
                                            {{item.IdentityNo}}
                                        </a>
                                        <a *ngIf="item.IdentityType==4" [routerLink]="['/admin/sales-quote/list']"
                                            [queryParams]="{QuoteId: item.IdentityId}" target="_blank" routerLink="#">
                                            {{item.IdentityNo}}
                                        </a>
                                        <a *ngIf="item.IdentityType==5" [routerLink]="['/admin/orders/sales-list']"
                                            [queryParams]="{SOId: item.IdentityId}" target="_blank" routerLink="#">
                                            {{item.IdentityNo}}
                                        </a>
                                        <a *ngIf="item.IdentityType==6" [routerLink]="['/admin/orders/purchase-list']"
                                            [queryParams]="{POId: item.IdentityId}" target="_blank" routerLink="#">
                                            {{item.IdentityNo}}
                                        </a>
                                        <a *ngIf="item.IdentityType==7" [routerLink]="['/admin/invoice/list']"
                                            [queryParams]="{InvoiceId:item.IdentityId}" target="_blank" routerLink="#">
                                            {{item.IdentityNo}}
                                        </a>
                                        <a *ngIf="item.IdentityType==8"
                                            [routerLink]="['/admin/invoice/vendor-invoice-list']"
                                            [queryParams]="{VendorInvoiceId: item.IdentityId}" target="_blank"
                                            routerLink="#">
                                            {{item.IdentityNo}}
                                        </a>
                                    </ng-container>

                                    <ng-container *ngIf="identityType == '2'">

                                        <a *ngIf="item.IdentityType==3" [routerLink]="['/vendor/RR-edit']"
                                            [queryParams]="{RRId: item.IdentityId}" target="_blank" routerLink="#">
                                            {{item.IdentityNo}}
                                        </a>


                                        <a *ngIf="item.IdentityType==6" [routerLink]="['/vendor/po-view']"
                                            [queryParams]="{POId: item.IdentityId}" target="_blank" routerLink="#">
                                            {{item.IdentityNo}}
                                        </a>

                                        <a *ngIf="item.IdentityType==8" [routerLink]="['/vendor/vendor-bill-view']"
                                            [queryParams]="{VendorInvoiceId: item.IdentityId}" target="_blank"
                                            routerLink="#">
                                            {{item.IdentityNo}}
                                        </a>
                                    </ng-container>

                                    <ng-container *ngIf="identityType == '1'">

                                        <a *ngIf="item.IdentityType==3" [routerLink]="['/customer/RR-edit']"
                                            [queryParams]="{RRId: item.IdentityId}" target="_blank" routerLink="#">
                                            {{item.IdentityNo}}
                                        </a>
                                        <a *ngIf="item.IdentityType==7" [routerLink]="['/customer/invoice-view']"
                                            [queryParams]="{InvoiceId:item.IdentityId}" target="_blank" routerLink="#">
                                            {{item.IdentityNo}}
                                        </a>


                                    </ng-container>
                                </ng-template>
                            </ng-select>
                            <!-- <input type="text" class="form-control" [(ngModel)]="searchQuery" name="searchQuery" (keyup.enter)="onEnter()" placeholder="Search..."> -->
                            <!-- <div class="input-group-append">
                                <button class="btn" (click)="onEnter()">
                                    <i class="fe-search"></i>
                                </button>
                            </div> -->
                        </div>
                    </div>
                </form>
            </li>
            <li class="dropdown d-none d-lg-block" ngbDropdown *ngIf="showadminonly">
                <a class="nav-link dropdown-toggle mr-0 waves-effect waves-light" href="javascript: void(0);"
                    role="button" aria-haspopup="false" aria-expanded="false" ngbDropdownToggle id="langDropdown">
                    <i class="remixicon-user-location-fill"></i>

                    <span class="pro-user-name ml-1">
                        {{LocationName}} <i class="mdi mdi-chevron-down"></i>
                    </span>
                </a>
                <div class="dropdown-menu dropdown-menu-right dropdown-menu-animated topbar-dropdown-menu"
                    aria-labelledby="langDropdown" ngbDropdownMenu>
                    <!-- item-->
                    <a *ngFor="let item of AllowLocationsDropdown;" href="javascript:void(0);"
                        class="dropdown-item notify-item" (click)="changeLocation(item)" ngbDropdownItem>
                        <span class="align-middle">{{ item.CountryName }}</span>
                    </a>
                </div>
            </li>
            <li class="dropdown d-none d-lg-block" *ngIf="showadminonly">
                <a (click)="viewMyWorkchain()" style="cursor:pointer;" ngbTooltip="My Workchain" placement="right"
                    class="nav-link dropdown-toggle mr-0 waves-effect waves-light">
                    <i class="remixicon-list-check"></i>
                    <span class="badge badge-info">{{workchainCount}}</span>
                </a>
            </li>

            <li class="dropdown d-none d-lg-block" *ngIf="cartCount>0">
                <a href="/#/admin/shop/cart" style="cursor:pointer;" ngbTooltip="My Cart" placement="right"
                    class="nav-link dropdown-toggle mr-0 waves-effect waves-light">
                    <i class="fa fa-shopping-cart fa-lg" aria-hidden="true"></i>
                    <span class="badge badge-info">{{cartCount}}</span>
                </a>
            </li>


            <li class="dropdown notification-list" ngbDropdown>
                <a class="nav-link dropdown-toggle nav-user mr-0 waves-effect waves-light" ngbDropdownToggle
                    id="profileDropdown" href="javascript: void(0);" role="button" aria-haspopup="false"
                    aria-expanded="false">
                    <img src="{{ProfilePhoto}}" *ngIf="ProfilePhoto" alt="user-image" class="rounded-circle">
                    <img src="assets\images\users\avatar.png"
                        *ngIf="ProfilePhoto=='' || ProfilePhoto==null || ProfilePhoto =='undefined'"
                        class="rounded-circle img-thumbnail avatar-xl" alt="profile-image">
                    <span class="pro-user-name ml-1">
                        {{UserName}} <i class="mdi mdi-chevron-down"></i>
                    </span>
                </a>
                <div class="dropdown-menu dropdown-menu-right profile-dropdown" aria-labelledby="profileDropdown"
                    ngbDropdownMenu>
                    <div class="dropdown-header noti-title">
                        <h6 class="text-overflow m-0">Welcome !</h6>
                    </div>

                    <a (click)="viewProfile()" class="dropdown-item notify-item" style="cursor:pointer;">
                        <i class="remixicon-account-circle-line"></i>
                        <span>My Account</span>
                    </a>

                    <a (click)="changePassword()" style="cursor:pointer;" class="dropdown-item notify-item"
                        *ngIf="showadminonly">
                        <i class="remixicon-lock-2-line"></i>
                        <span>Change Password</span>
                    </a>
                    <a (click)="viewMyWorkchain()" style="cursor:pointer;" class="dropdown-item notify-item"
                        *ngIf="showadminonly">
                        <i class="remixicon-list-check"></i>
                        <span>My Workchain</span>
                    </a>
                    <div class="dropdown-divider"></div>

                    <a href="javascript:void(0);" class="dropdown-item notify-item" (click)="logout()">
                        <i class="remixicon-logout-box-line"></i>
                        <span>Logout</span>
                    </a>

                </div>
            </li>

            <li class="dropdown notification-list" style="display: none;" ngbDropdown>
                <a class="nav-link dropdown-toggle  waves-effect waves-light" href="javascript: void(0);" role="button"
                    aria-haspopup="false" aria-expanded="false" ngbDropdownToggle id="notificationDropdown">
                    <i class="fe-bell noti-icon"></i>
                    <!-- <span class="badge badge-danger rounded-circle noti-icon-badge">8</span> -->
                </a>
                <div class="dropdown-menu dropdown-menu-right dropdown-menu-animated dropdown-lg"
                    aria-labelledby="notificationDropdown" ngbDropdownMenu>

                    <div class="dropdown-item noti-title" ngbDropdownItem>
                        <h5 class="m-0">
                            <span class="float-right">
                                <a href="javascript: void(0);" class="text-dark">
                                    <small>Clear All</small>
                                </a>
                            </span>Notification
                        </h5>
                    </div>

                    <div id="notification-items" class="slimscroll noti-scroll" appSlimScroll *ngIf="notification">
                        <a *ngFor="let notification of notificationItems;" href="{{ notification.redirectTo }}"
                            class="dropdown-item notify-item" ngbDropdownItem>
                            <div class="notify-icon bg-soft-primary text-primary">
                                <i class="mdi mdi-comment-account-outline"></i>
                            </div>
                            <p class="notify-details">{{ notification.ShortDesc }}
                                <small class="text-muted">{{ notification.CreatedByName }}</small>
                            </p>
                        </a>
                    </div>
                    <div id="notification-items" class="slimscroll noti-scroll" appSlimScroll
                        *ngIf="sideNavnotification">
                        <a *ngFor="let notification of notificationItems;" href="{{ notification.redirectTo }}"
                            class="dropdown-item notify-item" ngbDropdownItem>
                            <div class="notify-icon bg-soft-primary text-primary">
                                <i class="mdi mdi-comment-account-outline"></i>
                            </div>
                            <p class="notify-details">{{ notification.text }}
                                <small class="text-muted">{{ notification.subText }}</small>
                            </p>
                        </a>
                    </div>


                    <a href="javascript:void(0);" class="dropdown-item text-center text-primary notify-item notify-all">
                        View All
                    </a>
                </div>
            </li>

            <li class="dropdown notification-list" *ngIf="showadminonly">
                <a href="javascript:void(0);" class="nav-link right-bar-toggle waves-effect waves-light"
                    (click)="toggleRightSidebar()">
                    Quick Links
                    <i class="far fa-snowflake fa-lg"></i>
                </a>
            </li>


            <script>
                !
                    (
                        function () {
                            var session_id = localStorage.getItem("sessionid");
                            var userName = "Guest" // pass the variable that holds the username from session;
                            var email = "apps@growthfalcons.com"; // pass the variable that holds the user email from session;
                            localStorage.setItem("customData", JSON.stringify({
                                language: "en",
                                "userName": userName,
                                "email": email
                            }));

                            let e = document.createElement("script"),
                                t = document.head || document.getElementsByTagName("head")[0];
                            // console.log(t);
                            (e.src = "https://ea84-65-2-62-107.ngrok.io/rasa/lib/index.js"),
                                // Replace 1.x.x with the version that you want
                                (e.async = !0),
                                (e.onload = () => {
                                    window.WebChat.default({

                                        customData: {
                                            language: "en",
                                            "userName": userName,
                                            "email": email,
                                            "session_id": session_id
                                        },
                                        socketUrl: "https://1011-2600-1f18-13f0-5500-6ce0-ba0a-8e81-fa71.ngrok.io/",
                                        params: {
                                            storage: "session"
                                        }

                                    });
                                }),
                                t.insertBefore(e, t.firstChild);

                        }
                    )();
            </script>

        </ul>

        <div class="logo-box">
            <a href="javascript: void(0);" class="logo text-center">
                <span class="logo-lg">
                    <img src="{{logo}}" alt="" height="35"> 
                    <!-- <span class="text-danger ml-1" style="font-weight: bold;"
                        *ngIf="showadminonly">{{LocationName}}</span> -->
                    <!-- <span class="logo-lg-text-light">Xeria</span> -->
                </span>
                <span class="logo-sm">
                    <!-- <span class="logo-sm-text-dark">X</span> -->
                    <img src="{{smLogo}}" alt="" height="35"> 
                    <!-- <span class="text-danger ml-1" style="font-weight: bold;"
                        *ngIf="showadminonly">{{LocationName}}</span> -->
                </span>
            </a>
        </div>

        <ul class="list-unstyled topnav-menu topnav-menu-left m-0">
            <li *ngIf="showSideNav">
                <button class="button-menu-mobile waves-effect waves-light" (click)="toggleMobileMenu($event)">
                    <i class="fe-menu"></i>
                </button>
            </li>
            <!-- <li class="dropdown d-none d-lg-block" ngbDropdown *ngIf="showadminonly">
                <a class="nav-link dropdown-toggle waves-effect waves-light" routerLink="/admin/repair-request/add"
                    ngbDropdownToggle id="extraMenu" role="button" aria-haspopup="false" aria-expanded="false">
                    Add Repair Request -->
                    <!-- <i class="mdi mdi-chevron-down"></i> -->
                <!-- </a> -->


                <!-- <div class="dropdown-menu" ngbDropdownMenu aria-labelledby="extraMenu">
                    <a href="javascript:void(0);" class="dropdown-item">
                        <i class="fe-bar-chart-line- mr-1"></i>
                        <span>Revenue Report</span>
                    </a>

                    <a href="javascript:void(0);" class="dropdown-item">
                        <i class="fe-user mr-1"></i>
                        <span>Customer Report</span>
                    </a>

                    <a href="javascript:void(0);" class="dropdown-item">
                        <i class="fe-briefcase mr-1"></i>
                        <span>Vendor Report</span>
                    </a>

                    <a href="javascript:void(0);" class="dropdown-item">
                        <i class="fe-settings mr-1"></i>
                        <span>Settings</span>
                    </a>

                    <div class="dropdown-divider"></div>

                    <a href="javascript:void(0);" class="dropdown-item">
                        <i class="fe-headphones mr-1"></i>
                        <span>Help & Support</span>
                    </a>

                </div> -->
            <!-- </li> -->
        </ul>

        <!-- <a *ngIf="IsTopBulkShipping" class="nav-link dropdown-toggle waves-effect waves-light bst" routerLink="/admin/repair-request/bulk-shipping" role="button">
            Bulk Shipping
        </a> -->
    </div>
</div>
<ngx-spinner #ngxSpinner bdColor="rgba(0, 0, 0, 0.8)" size="medium" color="#fff" type="ball-spin-clockwise"
    [fullScreen]="true"></ngx-spinner>